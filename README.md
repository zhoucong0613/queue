# 双目相机客户端（支持深度与IMU处理）

## 📌SDK 简介

SDK实现了一个 **双目相机客户端程序**，主要功能是：

- 通过 **TCP/IP** 连接远程相机服务器；
- 接收多路同步数据流：
  - 左相机（YUV NV12）
  - 右相机（YUV NV12）
  - 深度图（16 位灰度）
  - IMU 数据（加速度计 + 陀螺仪）
- 将深度图转换为 **三维点云**；
- 提供 **实时预览**（深度伪彩色 + 灰度显示）；
- 支持 **性能统计** 和 **数据文件导出**，方便调试和验证。

该程序可应用于 **机器人、SLAM、AR/VR、深度感知** 等场景。

## ⚙️ 功能特性

- **深度处理**
  - 深度图转三维点云（XYZ）
  - 点云保存为 `.txt`
- **双目相机**
  - 接收左/右相机 NV12 数据
  - 转换为 BGR 并可视化
- **IMU 数据**
  - 解析并打印加速度计与陀螺仪数据
- **实时预览**
  - 窗口显示深度图（Jet 伪彩色 + 灰度图）
- **性能统计**
  - 处理帧率与耗时分析
- **调试与数据导出**
  - 支持周期性导出原始图像、深度二进制文件、点云文件

## 🏗️ 编译方法

```
mkdir build
cd build
cmake ..
make
```

## ▶️ 使用方法

### 命令行参数

```
./stereo_client [选项]
```

| 短参数 | 长参数        | 参数类型 | 说明                    |
| ------ | ------------- | -------- | ----------------------- |
| `-i`   | `--interface` | 字符串   | 指定网络接口（如 `usb0` |
| `-s`   | `--server`    | 字符串   | 服务器 IP 地址          |
| `-v`   | `--verbose`   | 整数     | 日志模式（按位标志）    |
| `-p`   | `--preview`   | 无参数   | 启用实时预览窗口        |
| `-d`   | `--dump`      | 整数     | 导出模式（按位标志）    |

### verbose 日志标志

- `1` → 流头信息
- `2` → 左/右相机原始 NV12 信息
- `4` → 深度与点云信息
- `8` → IMU 信息

### dump 导出标志

- `1` → 导出左右相机 NV12
- `2` → 导出深度二进制文件
- `4` → 导出点云 `.txt`

## 📊 示例

1. 使用网卡usb0 连接服务器 `192.168.5.5`，启用预览和深度日志：

```
ifconfig usb0 mtu 9000
./stereo_client -i usb0 -s 192.168.5.5 -p -v 4
```

   2.连接服务器，并每 10 帧导出一次深度和点云：

```
ifconfig usb0 mtu 9000
./stereo_client -i usb0 -s 192.168.5.5 -d 6
```

1. 最小运行（只接收数据）：

```
ifconfig usb0 mtu 9000
./stereo_client -i usb0 -s 192.168.5.5
```

## 📂 输出文件

根据导出模式，可能生成以下文件：

- `depth_cnt[N].bin` → 原始深度二进制
- `pointcloud_cnt[N].txt` → 三维点云数据
- `Right_client_Raw_cnt[N].yuv` → 右相机原始 NV12
- `Left_client_Raw_cnt[N].yuv` → 左相机原始 NV12

## 🧪 性能统计

程序内置性能测试工具：

- 默认运行 `30*60` 次迭代
- 统计消费者线程耗时
- 统计深度转点云耗时

## 📌 注意事项

- 客户端确保能够连接服务器，`ping 192.168.5.5`

- 客户端网口的mtu需设置成9000，`ifconfig usb0 mtu 9000`

- 点云坐标默认深度单位为 **毫米**。

  
